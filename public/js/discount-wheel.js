!function(){"use strict";let e=[5,10,15,20,25],t=["#fff5f5","#ffe1e1","#ffc9c9","#ffacac","#df0303"],n=(e,t=document)=>t.querySelector(e),l={get nSpins(){return+localStorage.getItem("dw.spins")||0},set nSpins(v){localStorage.setItem("dw.spins",String(v))},get claimed(){return localStorage.getItem("dw.claimed")},set claimed(v){localStorage.setItem("dw.claimed",v)},get closedAt(){return+localStorage.getItem("dw.closedAt")||0},set closedAt(v){localStorage.setItem("dw.closedAt",String(v))}};async function o(e){let t=await html2canvas(e,{backgroundColor:null,scale:Math.min(2,window.devicePixelRatio||1.5)});return new Promise(e=>t.toBlob(t=>e(t),"image/png",.92))}function i(e=4e3){let n=document.createElement("canvas");n.style.position="fixed",n.style.inset="0",n.style.pointerEvents="none",n.style.zIndex="100000",document.body.appendChild(n);let l=n.getContext("2d"),o,i,a=()=>{o=n.width=innerWidth,i=n.height=innerHeight};a(),addEventListener("resize",a);let s=Math.min(300,Math.floor(o*i/12e3)),d=Array.from({length:s},()=>({x:Math.random()*o,y:-20-Math.random()*i*.3,s:5+7*Math.random(),a:Math.random()*Math.PI,v:1.5+3.5*Math.random(),w:.2*Math.random()+.05,c:t[Math.floor(Math.random()*t.length)]})),r=performance.now();!function t(s){l.clearRect(0,0,o,i),d.forEach(e=>{e.y+=e.v+2*Math.random(),e.x+=.8*Math.sin(e.a+=e.w),l.save(),l.translate(e.x,e.y),l.rotate(2*e.a),l.fillStyle=e.c,l.fillRect(-e.s/2,-e.s/2,e.s,e.s),l.restore()}),s-r<e?requestAnimationFrame(t):(document.body.removeChild(n),removeEventListener("resize",a))}(r)}function a(){let o=n("#dw-overlay");if(!o)return;let a=n("#dw-canvas",o),s=n("#dw-spin",o),d=o.querySelector(".dw-close"),r=n("#dw-result",o),c=n("#dw-result-value",o),$=n("#dw-copy",o),u=n("#dw-note",o);!function n(l){let o=l.getContext("2d"),i=l.width,a=l.height,s=i/2,d=a/2,r=Math.min(i,a)/2-4;o.clearRect(0,0,i,a);let c=2*Math.PI/e.length;for(let $=0;$<e.length;$++){let u=$*c,f=u+c;o.beginPath(),o.moveTo(s,d),o.arc(s,d,r,u,f),o.closePath(),o.fillStyle=t[$%t.length],o.fill(),o.save(),o.translate(s,d);let m=u+c/2;o.rotate(m),o.textAlign="right",o.fillStyle="#111",o.font="bold 22px system-ui,-apple-system,Segoe UI,Roboto,Arial",o.fillText(e[$]+"%",r-16,8),o.restore()}o.beginPath(),o.arc(s,d,50,0,2*Math.PI),o.fillStyle="#fff",o.fill(),o.lineWidth=2,o.strokeStyle="#111",o.stroke(),o.fillStyle="#111",o.font="bold 14px system-ui,-apple-system,Segoe UI,Roboto,Arial",o.textAlign="center";let h=window.DW_I18N&&window.DW_I18N.spin_center||"SPIN";o.fillText(h.toUpperCase(),s,d+5)}(a);let f=!1,m=e.length,h=360/m;function _(){o.classList.add("show"),o.setAttribute("aria-hidden","false")}function g(){o.classList.remove("show"),o.setAttribute("aria-hidden","true"),l.closedAt=Date.now()}window.DiscountWheel={show:_,hide:g},!l.claimed&&Date.now()-l.closedAt>432e5&&setTimeout(_,1e3),d.addEventListener("click",g),o.addEventListener("click",e=>{e.target===o&&g()}),s.addEventListener("click",()=>{if(f)return;s.hidden=!0;let t=window.DW_I18N||{};if(l.claimed){let n=(t.already_unlocked||"Discount already unlocked: :value%").replace(":value",l.claimed);u.textContent=n,c.textContent=l.claimed+"%",r.hidden=!1,i(2500);return}f=!0,u.textContent=t.good_luck||"Good luck!",s.disabled=!0;let o=function e(t){let n=t>=2?[78,22]:[65,35],l=Math.random()*(n[0]+n[1]);return l<n[0]?0:1}(l.nSpins),d=e[o];a.style.transform=`rotate(${360*(4+Math.floor(2*Math.random()))+(270-(o+.5)*h)}deg)`,setTimeout(()=>{l.nSpins=l.nSpins+1,c.textContent=d+"%",r.hidden=!1,l.claimed=String(d),u.textContent=t.congrats||"Congratulations! Your discount is ready.",i(3800),f=!1,s.disabled=!0},6100)}),$.addEventListener("click",()=>{let e=l.claimed||"5",t=$.dataset.waPhone||"16393903194",n=$.dataset.waTemplate||"Hello, I got :discount% discount. Can you activate my subscription?",i=n.replace(":discount",e),a=`https://wa.me/${t}?text=${encodeURIComponent(i)}`;"function"==typeof window.DiscountWheel?.hide?window.DiscountWheel.hide():(o.classList.remove("show"),o.setAttribute("aria-hidden","true"),l.closedAt=Date.now()),setTimeout(()=>{window.location.href=a},120)})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a,{once:!0}):a()}();